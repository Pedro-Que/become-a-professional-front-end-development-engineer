# 移动端适配

## 前言

移动互联网发展至今，各种移动设备应运而生，但它们的物理分辨率可以说是五花八门，一般情况UI会为我们提供375尺寸或者750尺寸的设计稿，所以为了让H5页面能够在这些不同的设备上尽量表现的一致，前端工程师就不得不对页面进行移动端适配了。

## 前置知识

在学习移动端适配前我们需要了解一些相关的前置知识。

| 设备                  | 平台    | 屏幕尺寸（in） | 长宽比 | 逻辑像素（dp） | 物理像素（px） | 倍率 |
| --------------------- | ------- | -------------- | ------ | -------------- | -------------- | ---- |
| Android One           | Android | 4.5    2.2*3.9 | 16:9   | 320*569        | 480*854        | 1.5  |
| Moto G                | Android | 4.5    2.2*3.9 | 16:9   | 360*640        | 720*1280       | 2    |
| Moto X                | Android | 4.7    2.3*4.1 | 16:9   | 360*640        | 720*1280       | 2    |
| Moto X (2nd Gen)      | Android | 5.2    2.5*4.5 | 16:9   | 360*640        | 1080*1920      | 3    |
| Nexus 5               | Android | 5.0    2.4*4.3 | 16:9   | 360*640        | 1080*1920      | 3    |
| Samsung Galaxy Note 4 | Android | 5.7    2.8*5.0 | 16:9   | 480*853        | 1440*2560      | 3    |
| Samsung Galaxy S5     | Android | 5.1    2.9*5.6 | 16:9   | 360*640        | 1080*1920      | 3    |
| Samsung Galaxy S6     | Android | 5.1    2.5*4.4 | 16:9   | 360*640        | 1440*2560      | 4    |
| iPhone                | IOS     | 3.5    1.9*2.9 | 3:2    | 320*480        | 320*480        | 1    |
| iPhone 4              | IOS     | 3.5    2.0*2.9 | 3:2    | 320*480        | 640*960        | 2    |
| iPhone 5              | IOS     | 4.0    2.0*3.5 | 16:9   | 320*568        | 640*1136       | 2    |
| iPhone 6              | IOS     | 4.7    2.3*4.1 | 16:9   | 375*667        | 750*1334       | 2    |

#### 屏幕尺寸

> 屏幕尺寸是指显示器、电视等显示设备的对角线长度，通常用英寸（inch）作为单位表示。`1英寸=2.54厘米`

电子设备一般都用英寸来描述屏幕的物理大小，比如我们使用的手机、电脑等设备。常见的电脑尺寸有13、22、27英寸等。英寸（inch，缩写为in）在荷兰语中的意思指的是大拇指，一英寸就是指普通人的拇指宽度。

#### 像素pixel

> 像素(pixel)是计算机图像处理中最基本的单元，指的是图像中最小的可控制的点。每个像素都有一个特定的位置和色彩值，用于构成整个图像。图像的清晰度、细节和颜色深度等特性都取决于像素的数量和排列方式。在数字图像中，像素通常用二进制数据表示，每个像素的色彩值由若干位的二进制数来表示，每位二进制数被称为一个“比特（bit）”，比特的数量越多，则可以表示的颜色数量也越多。例如，一张 800x600 像素的图像，就是由 480,000 个像素组成的。

#### 屏幕分辨率

> 屏幕分辨率是指显示设备在水平和垂直方向上所能显示的像素点数，通常用宽度像素数×高度像素数的方式表示。例如，1366×768 的屏幕分辨率指的是显示器在水平方向上有 1366 个像素，在垂直方向上有 768 个像素。屏幕分辨率越高，能够显示的图像细节和清晰度就越高，图像也会更加真实、自然。

我们可以看到上图中有两种像素：逻辑像素与物理像素，并且它们数值不一样，还有就是为什么一般UI给我们提供的设计稿上的分辨率与真实机型的分辨率不一样。

#### 物理像素

> 物理像素（也称为设备像素）是显示设备中的最小物理单元，用于在屏幕上显示图像和文本。物理像素的数量决定了屏幕的分辨率，即屏幕上可以显示多少像素。
>
> 每个物理像素由一个红、绿、蓝（RGB）三个子像素构成，它们合在一起形成一个完整的像素。在计算机显示器上，物理像素通常呈现为一个小的正方形或矩形。物理像素的大小可以根据显示器的大小和分辨率而不同。
>
> 在移动设备上，一个物理像素通常对应于一个逻辑像素（也称为CSS像素），即网页设计师所使用的像素单位。这意味着在高分辨率屏幕上，一个物理像素可能显示多个逻辑像素，使文本和图像看起来更加清晰和锐利。

在同一个设备上，它的物理像素是固定的，也就是厂家在生产显示设备时就决定的实际点的个数，对于不同设备物理像素点的大小是不一样的。（设备控制显示的最小单位，我们常说的1920*1080像素分辨素就是用的物理像素单位）

如果都使用物理像素就会带来问题：举个例子，21英寸显示器的分辨率是1440x1080，5.8英寸的iPhone X的分辨率是2436×1125，我们用CSS画一条线，其长度是20px，如果都以物理像素作为度量单位，那么在显示器上看起来正常，在iPhone X屏幕上就变得非常小。

#### 逻辑像素

> 逻辑像素（也称为CSS像素）是一种虚拟的单位，通常用于网页设计中。它是在网页上显示文本和图像的基本单位，用于定义元素的大小、位置和间距等。
>
> 逻辑像素的大小并不是固定的，它可以根据显示设备的分辨率和缩放级别而变化。在高分辨率屏幕上，一个逻辑像素可以对应多个物理像素，以确保图像和文本的清晰度和锐利度。而在低分辨率屏幕上，一个逻辑像素可以对应一个物理像素。
>
> 逻辑像素是一种与设备无关的像素单位，因此可以在不同设备上保持一致的大小和外观。这使得网页设计师可以更好地控制网页的布局和外观，使其在不同设备上都能够呈现出良好的效果。

OK，其实乔大大在之前就想到了会有这个问题，苹果在iPhone4的发布会上首次提出了Retina Display（视网膜屏幕）的概念，在iPhone4使用的视网膜屏幕中，把4个像素当1个像素使用，这样让屏幕看起来更精致，并且在不同屏幕中，相同的逻辑像素呈现的尺寸是一致的。所以高分辨率的设备，多了一个逻辑像素。我们从第一张图中可以看到不同设备的逻辑像素仍然是有差异的，只不过差异没有物理像素那么大，于是便诞生了移动端页面需要适配这个问题。（与设备无关的逻辑像素，代表可以通过程序控制使用的虚拟像素）

#### PPI

> PPI全称为Pixels Per Inch，指的是每英寸像素数量，是用于测量屏幕、打印机和其他显示设备分辨率的单位。PPI值越高，屏幕上的图像和文本就会更清晰、更锐利。
>
> 在屏幕上，PPI是根据屏幕分辨率和屏幕尺寸计算出来的。例如，一个1920x1080像素分辨率的23英寸屏幕，其PPI为96。而同样分辨率的13英寸屏幕，其PPI则更高，大约为168。
>
> 在打印机上，PPI指的是打印机每英寸可以打印的点数。这个概念类似于屏幕上的PPI，但是在打印机上它被称为DPI（Dots Per Inch）。
>
> 需要注意的是，PPI并不是唯一决定屏幕或打印品质的因素，其他因素如显示技术、色彩表现、对比度等也会影响显示效果。但PPI是衡量设备分辨率的重要指标之一。

它的计算公式为：`PPI = √(横向像素数² + 纵向像素数²) / 屏幕对角线尺寸`（其中，横向像素数和纵向像素数是屏幕的水平像素数和垂直像素数，屏幕对角线尺寸是指屏幕的对角线长度，通常以英寸（inch）为单位）

* PPI低于100的屏幕，像素密度较低，显示效果相对较差，特别是在显示小字体、线条等细节时会出现锯齿或模糊现象。
* PPI在100-200之间的屏幕，像素密度较为适中，显示效果相对较好，特别是在日常使用场景下效果良好。
* PPI超过200的屏幕，像素密度较高，显示效果非常出色，特别是在高清视频、游戏等要求高清晰度的场景下表现非常突出。

#### DPR

> DPR全称为Device Pixel Ratio，指的是设备像素比，是用于描述设备像素和CSS像素之间关系的比率。在高分辨率屏幕设备上，一个CSS像素可能对应多个设备像素，这时DPR可以告诉浏览器如何渲染网页，以适应不同的设备像素密度。

它的计算公式为：`DPR = 物理像素宽度 / CSS像素宽度`

当设备像素比为1:1时，使用1（1×1）个设备像素显示1个CSS像素；

当设备像素比为2:1时，使用4（2×2）个设备像素显示1个CSS像素；

当设备像素比为3:1时，使用9（3×3）个设备像素显示1个CSS像素。

#### 概念关系图

屏幕尺寸、屏幕分辨率-->对角线分辨率/屏幕尺寸-->屏幕像素密度PPI | 设备像素比dpr = 物理像素 / 设备独立像素dip(dp) | viewport: scale | CSS像素px

#### Viewport

Viewport（视口）是指浏览器窗口或app中webview显示网页的区域。一般来讲PC端的视口指的是浏览器窗口区域，而移动端就有点复杂，它有三个视口：

* **layout viewport**：布局视口
* **visual viewport**：视觉视口
* **ideal viewport**：理想视口